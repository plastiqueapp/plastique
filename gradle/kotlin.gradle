tasks.withType(project.buildscript.classLoader.loadClass("org.jetbrains.kotlin.gradle.tasks.KotlinCompile")).configureEach {
    kotlinOptions {
        jvmTarget = "1.8"
        freeCompilerArgs = ["-Xnew-inference", "-Xinline-classes"]

        if (name.toLowerCase().contains("release")) {
            allWarningsAsErrors = true
            freeCompilerArgs += ["-Xno-call-assertions", "-Xno-param-assertions", "-Xno-receiver-assertions"]
        }
    }
}
